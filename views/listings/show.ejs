<section class="show-section">

    <h2>
        <%= data.title %>
    </h2>

    <img class="show-image" src="<%= data.photos.path %>" alt="<%=data.photos.filename  %>">

    <h3>
        <%= data.propertyType %> in <%= data.address %>
    </h3>



    <p class="space-details">
        <%= data.maxGuests %> guests &nbsp; &bull; &nbsp;<%= data.bedrooms %> bedrooms &nbsp; &bull; &nbsp;<%= data.beds
                    %> beds &nbsp; &bull; &nbsp;<%= data. bathroom %> bathrooms
    </p>

    <h4>Hosted by <%= data.host.username %>
    </h4>

    <% if(currUser && currUser._id.equals(data.host._id)){ %>
        <div class="buttons">
            <a class="update-listing btn" href="/listing/<%= data._id %>/edit">update</a>
            <form action="/listing/<%= data._id %>?_method=DELETE" method="post">
                <a class="delete-listing btn" type="submit">delete</a>
            </form>
        </div>
        <% } %> <!-- we must handle these thing in frontend as well as backend -->
            <hr>

            <div class="description">
                <h5>Description</h5>

                <p>
                    <%= data.description %>
                </p>

            </div>

            <hr>

            <h2>Review section</h2>


            <% if(currUser){ %>
                <form class="review-form" action="/listing/<%= data._id %>/review" method="post">
                    <fieldset class="starability-coinFlip">
                        <input type="radio" id="no-rate" class="input-no-rate" name="rating" value="1" checked
                            aria-label="No rating." />
                        <input type="radio" id="first-rate1" name="rating" value="1" />
                        <label for="first-rate1" title="Terrible">1 star</label>
                        <input type="radio" id="first-rate2" name="rating" value="2" />
                        <label for="first-rate2" title="Not good">2 stars</label>
                        <input type="radio" id="first-rate3" name="rating" value="3" />
                        <label for="first-rate3" title="Average">3 stars</label>
                        <input type="radio" id="first-rate4" name="rating" value="4" />
                        <label for="first-rate4" title="Very good">4 stars</label>
                        <input type="radio" id="first-rate5" name="rating" value="5" />
                        <label for="first-rate5" title="Amazing">5 stars</label>
                    </fieldset>


                    <textarea cols="15" rows="8" name="comment" id="" required></textarea>
                    <br>
                    <button class="submit-review" type="submit">submit</button>
                </form>

                <% } %>

                    <div class="review-box-parent">
                        <div class="center">
                            <% if(data.comments.length===0){ %>
                                <p>No review posted</p>

                                <% } else{%>
                                    <% for(let item of data.comments){ %>
                                        <div class="review-box">
                                            <h5>@<%= item.author.username %>
                                            </h5>

                                            <p class="starability-result" data-rating="<%= item.rating %>">
                                            </p>
                                            <i>
                                                <%= item.comment %>
                                            </i>


                                            <form
                                                action="/listing/<%= data._id %>/review/<%= item._id %>?_method=DELETE"
                                                method="post">
                                                <button class="delete-review">Delete</button>
                                            </form>
                                        </div>
                                        <% } %>
                                            <% } %>


                        </div>

                    </div>


</section>